!function(e,t){for(var i in t)e[i]=t[i]}(exports,function(e){var t={};function i(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=e,i.c=t,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(r,n,function(t){return e[t]}.bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=4)}([function(e,t){e.exports=require("vscode")},function(e,t){e.exports=require("path")},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,n,s,o,a,c=i(1),l=i(6),u=Object.prototype.toString;function d(e){return void 0!==e}function h(e){return"[object String]"===u.call(e)}function g(e){return JSON.parse(l.readFileSync(e,"utf8"))}function v(e,t){return a&&(e="［"+e.replace(/[aouei]/g,"$&$&")+"］"),0===t.length?e:e.replace(/\{(\d+)\}/g,function(e,i){var r=i[0],n=t[r],s=e;return"string"==typeof n?s=n:"number"!=typeof n&&"boolean"!=typeof n&&void 0!==n&&null!==n||(s=String(n)),s})}function f(e){return function(t,i){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return function(e){return"[object Number]"===u.call(e)}(t)?t>=e.length?void console.error("Broken localize call found. Index out of bounds. Stacktrace is\n: "+new Error("").stack):v(e[t],r):h(i)?(console.warn("Message "+i+" didn't get externalized correctly."),v(i,r)):void console.error("Broken localize call found. Stacktrace is\n: "+new Error("").stack)}}function p(e,t){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];return v(t,i)}function w(e,t){return s[e]=t,t}function m(e,t){var i,r=c.join(o.cacheRoot,e.id+"-"+e.hash+".json"),n=!1,s=!1;try{return i=JSON.parse(l.readFileSync(r,{encoding:"utf8",flag:"r"})),function(e){var t=new Date;l.utimes(e,t,t,function(){})}(r),i}catch(e){if("ENOENT"===e.code)s=!0;else{if(!(e instanceof SyntaxError))throw e;console.log("Syntax error parsing message bundle: "+e.message+"."),l.unlink(r,function(e){e&&console.error("Deleting corrupted bundle "+r+" failed.")}),n=!0}}if(!(i=function(e,t){var i=o.translationsConfig[e.id];if(i){var r=g(i).contents,n=g(c.join(t,"nls.metadata.json")),s=Object.create(null);for(var a in n){var l=n[a],u=r[e.outDir+"/"+a];if(u){for(var d=[],v=0;v<l.keys.length;v++){var f=l.keys[v],p=u[h(f)?f:f.key];void 0===p&&(p=l.messages[v]),d.push(p)}s[a]=d}else s[a]=l.messages}return s}}(e,t))||n)return i;if(s)try{l.writeFileSync(r,JSON.stringify(i),{encoding:"utf8",flag:"wx"})}catch(e){if("EEXIST"===e.code)return i;throw e}return i}function b(e){try{return function(e){var t=g(c.join(e,"nls.metadata.json")),i=Object.create(null);for(var r in t){var n=t[r];i[r]=n.messages}return i}(e)}catch(e){return void console.log("Generating default bundle from meta data failed.",e)}}function S(e,t){var i;if(!0===o.languagePackSupport&&void 0!==o.cacheRoot&&void 0!==o.languagePackId&&void 0!==o.translationsConfigFile&&void 0!==o.translationsConfig)try{i=m(e,t)}catch(e){console.log("Load or create bundle failed ",e)}if(!i){if(o.languagePackSupport)return b(t);var r=function(e){for(var t=o.locale;t;){var i=c.join(e,"nls.bundle."+t+".json");if(l.existsSync(i))return i;var r=t.lastIndexOf("-");t=r>0?t.substring(0,r):void 0}if(void 0===t&&(i=c.join(e,"nls.bundle.json"),l.existsSync(i)))return i}(t);if(r)try{return g(r)}catch(e){console.log("Loading in the box message bundle failed.",e)}i=b(t)}return i}function y(e){if(!e)return p;var t=c.extname(e);if(t&&(e=e.substr(0,e.length-t.length)),o.messageFormat===r.both||o.messageFormat===r.bundle){var i=function(e){for(var t,i=c.dirname(e);t=c.join(i,"nls.metadata.header.json"),!l.existsSync(t);){var r=c.dirname(i);if(r===i){t=void 0;break}i=r}return t}(e);if(i){var n=c.dirname(i),u=s[n];if(void 0===u)try{var h=JSON.parse(l.readFileSync(i,"utf8"));try{var v=S(h,n);u=w(n,v?{header:h,nlsBundle:v}:null)}catch(e){console.error("Failed to load nls bundle",e),u=w(n,null)}}catch(e){console.error("Failed to read header file",e),u=w(n,null)}if(u){var m=e.substr(n.length+1).replace(/\\/g,"/"),b=u.nlsBundle[m];return void 0===b?(console.error("Messages for file "+e+" not found. See console for details."),function(){return"Messages not found."}):f(b)}}}if(o.messageFormat===r.both||o.messageFormat===r.file)try{var y=g(function(e){var t;if(o.cacheLanguageResolution&&t)t=t;else{if(a||!o.locale)t=".nls.json";else for(var i=o.locale;i;){var r=".nls."+i+".json";if(l.existsSync(e+r)){t=r;break}var n=i.lastIndexOf("-");n>0?i=i.substring(0,n):(t=".nls.json",i=null)}o.cacheLanguageResolution&&(t=t)}return e+t}(e));return Array.isArray(y)?f(y):d(y.messages)&&d(y.keys)?f(y.messages):(console.error("String bundle '"+e+"' uses an unsupported format."),function(){return"File bundle has unsupported format. See console for details"})}catch(e){"ENOENT"!==e.code&&console.error("Failed to load single file bundle",e)}return console.error("Failed to load message bundle for file "+e),function(){return"Failed to load message bundle. See console for details."}}!function(e){e.file="file",e.bundle="bundle",e.both="both"}(r=t.MessageFormat||(t.MessageFormat={})),function(e){e.is=function(e){var t=e;return t&&d(t.key)&&d(t.comment)}}(n||(n={})),function(){if(o={locale:void 0,languagePackSupport:!1,cacheLanguageResolution:!0,messageFormat:r.bundle},h(process.env.VSCODE_NLS_CONFIG))try{var e=JSON.parse(process.env.VSCODE_NLS_CONFIG);if(h(e.locale)&&(o.locale=e.locale.toLowerCase()),function(e){return!0===e||!1===e}(e._languagePackSupport)&&(o.languagePackSupport=e._languagePackSupport),h(e._cacheRoot)&&(o.cacheRoot=e._cacheRoot),h(e._languagePackId)&&(o.languagePackId=e._languagePackId),h(e._translationsConfigFile)){o.translationsConfigFile=e._translationsConfigFile;try{o.translationsConfig=g(o.translationsConfigFile)}catch(t){e._corruptedFile&&l.writeFile(e._corruptedFile,"corrupted","utf8",function(e){console.error(e)})}}}catch(e){}a="pseudo"===o.locale,void 0,s=Object.create(null)}(),t.loadMessageBundle=y,t.config=function(e){return e&&(h(e.locale)&&(o.locale=e.locale.toLowerCase(),void 0,s=Object.create(null)),void 0!==e.messageFormat&&(o.messageFormat=e.messageFormat)),a="pseudo"===o.locale,y}},function(e,t,i){"use strict";function r(e){for(;e.length;){const t=e.pop();t&&t.dispose()}}Object.defineProperty(t,"__esModule",{value:!0}),t.disposeAll=r;t.Disposable=class{constructor(){this._isDisposed=!1,this._disposables=[]}dispose(){this._isDisposed||(this._isDisposed=!0,r(this._disposables))}_register(e){return this._isDisposed?e.dispose():this._disposables.push(e),e}get isDisposed(){return this._isDisposed}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i(0),n=i(5),s=i(7),o=i(8);t.activate=function(e){const t=r.Uri.file(e.extensionPath),i=new s.SizeStatusBarEntry;e.subscriptions.push(i);const a=new o.ZoomStatusBarEntry;e.subscriptions.push(a);const c=new n.PreviewManager(t,i,a);e.subscriptions.push(r.window.registerWebviewEditorProvider(n.PreviewManager.viewType,{async resolveWebviewEditor(e,t){c.resolve(e,t)}})),e.subscriptions.push(r.commands.registerCommand("imagePreview.zoomIn",()=>{var e;null===(e=c.activePreview)||void 0===e||e.zoomIn()})),e.subscriptions.push(r.commands.registerCommand("imagePreview.zoomOut",()=>{var e;null===(e=c.activePreview)||void 0===e||e.zoomOut()}))}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i(0),n=i(2),s=i(3),o=n.loadMessageBundle(i(1).join(__dirname,"preview.ts"));class a{constructor(e,t,i){this.extensionRoot=e,this.sizeStatusBarEntry=t,this.zoomStatusBarEntry=i,this._previews=new Set}resolve(e,t){const i=new c(this.extensionRoot,e,t,this.sizeStatusBarEntry,this.zoomStatusBarEntry);this._previews.add(i),this.setActivePreview(i),t.onDidDispose(()=>{this._previews.delete(i)}),t.onDidChangeViewState(()=>{t.active?this.setActivePreview(i):this._activePreview!==i||t.active||this.setActivePreview(void 0)})}get activePreview(){return this._activePreview}setActivePreview(e){this._activePreview=e,this.setPreviewActiveContext(!!e)}setPreviewActiveContext(e){r.commands.executeCommand("setContext","imagePreviewFocus",e)}}t.PreviewManager=a,a.viewType="imagePreview.previewEditor";class c extends s.Disposable{constructor(e,t,i,n,s){super(),this.extensionRoot=e,this.resource=t,this.webviewEditor=i,this.sizeStatusBarEntry=n,this.zoomStatusBarEntry=s,this.id=`${Date.now()}-${Math.random().toString()}`,this._previewState=1;const o=t.with({path:t.path.replace(/\/[^\/]+?\.\w+$/,"/")});i.webview.options={enableScripts:!0,localResourceRoots:[o,e]},this._register(i.webview.onDidReceiveMessage(e=>{switch(e.type){case"size":this._imageSize=e.value,this.update();break;case"zoom":this._imageZoom=e.value,this.update()}})),this._register(s.onDidChangeScale(e=>{2===this._previewState&&this.webviewEditor.webview.postMessage({type:"setScale",scale:e.scale})})),this._register(i.onDidChangeViewState(()=>{this.update()})),this._register(i.onDidDispose(()=>{2===this._previewState&&(this.sizeStatusBarEntry.hide(this.id),this.zoomStatusBarEntry.hide(this.id)),this._previewState=0}));const a=this._register(r.workspace.createFileSystemWatcher(t.fsPath));this._register(a.onDidChange(e=>{e.toString()===this.resource.toString()&&this.render()})),this._register(a.onDidDelete(e=>{e.toString()===this.resource.toString()&&this.webviewEditor.dispose()})),this.render(),this.update()}zoomIn(){2===this._previewState&&this.webviewEditor.webview.postMessage({type:"zoomIn"})}zoomOut(){2===this._previewState&&this.webviewEditor.webview.postMessage({type:"zoomOut"})}render(){0!==this._previewState&&(this.webviewEditor.webview.html=this.getWebiewContents())}update(){0!==this._previewState&&(this.webviewEditor.active?(this._previewState=2,this.sizeStatusBarEntry.show(this.id,this._imageSize||""),this.zoomStatusBarEntry.show(this.id,this._imageZoom||"fit")):(2===this._previewState&&(this.sizeStatusBarEntry.hide(this.id),this.zoomStatusBarEntry.hide(this.id)),this._previewState=1),this.webviewEditor.webview.postMessage({type:"setActive",value:this.webviewEditor.active}))}getWebiewContents(){const e=Date.now().toString(),t={isMac:"darwin"===process.platform,src:this.getResourcePath(this.webviewEditor,this.resource,e)},i=Date.now().toString();return`<!DOCTYPE html>\n<html lang="en">\n<head>\n\t<meta charset="UTF-8">\n\t<meta name="viewport" content="width=device-width, initial-scale=1.0">\n\t<meta http-equiv="X-UA-Compatible" content="ie=edge">\n\t<title>Image Preview</title>\n\t<link rel="stylesheet" href="${l(this.extensionResource("/media/main.css"))}" type="text/css" media="screen" nonce="${i}">\n\t<meta http-equiv="Content-Security-Policy" content="default-src 'none'; img-src 'self' data: ${this.webviewEditor.webview.cspSource}; script-src 'nonce-${i}'; style-src 'self' 'nonce-${i}';">\n\t<meta id="image-preview-settings" data-settings="${l(JSON.stringify(t))}">\n</head>\n<body class="container image scale-to-fit loading">\n\t<div class="loading-indicator"></div>\n\t<div class="image-load-error-message">${o(0,null)}</div>\n\t<script src="${l(this.extensionResource("/media/main.js"))}" nonce="${i}"><\/script>\n</body>\n</html>`}getResourcePath(e,t,i){switch(t.scheme){case"data":return encodeURI(t.toString(!0));case"git":return encodeURI("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAEElEQVR42gEFAPr/AP///wAI/AL+Sr4t6gAAAABJRU5ErkJggg==");default:return encodeURI(e.webview.asWebviewUri(t).toString(!0)+`?version=${i}`)}}extensionResource(e){return this.webviewEditor.webview.asWebviewUri(this.extensionRoot.with({path:this.extensionRoot.path+e}))}}function l(e){return e.toString().replace(/"/g,"&quot;")}},function(e,t){e.exports=require("fs")},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i(0),n=i(3),s=i(2).loadMessageBundle(i(1).join(__dirname,"sizeStatusBarEntry.ts"));t.SizeStatusBarEntry=class extends n.Disposable{constructor(){super(),this._entry=this._register(r.window.createStatusBarItem({id:"imagePreview.size",name:s(0,null),alignment:r.StatusBarAlignment.Right,priority:101}))}show(e,t){this._showingOwner=e,this._entry.text=t,this._entry.show()}hide(e){e===this._showingOwner&&(this._entry.hide(),this._showingOwner=void 0)}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=i(0),n=i(2),s=i(3),o=n.loadMessageBundle(i(1).join(__dirname,"zoomStatusBarEntry.ts")),a="_imagePreview.selectZoomLevel";t.ZoomStatusBarEntry=class extends s.Disposable{constructor(){super(),this._onDidChangeScale=this._register(new r.EventEmitter),this.onDidChangeScale=this._onDidChangeScale.event,this._entry=this._register(r.window.createStatusBarItem({id:"imagePreview.zoom",name:o(0,null),alignment:r.StatusBarAlignment.Right,priority:102})),this._register(r.commands.registerCommand(a,async()=>{const e=[10,5,2,1,.5,.2,"fit"].map(e=>({label:this.zoomLabel(e),scale:e})),t=await r.window.showQuickPick(e,{placeHolder:o(1,null)});t&&this._onDidChangeScale.fire({scale:t.scale})})),this._entry.command=a}show(e,t){this._showOwner=e,this._entry.text=this.zoomLabel(t),this._entry.show()}hide(e){e===this._showOwner&&(this._entry.hide(),this._showOwner=void 0)}zoomLabel(e){return"fit"===e?o(2,null):`${Math.round(100*e)}%`}}}]));
//# sourceMappingURL=https://ticino.blob.core.windows.net/sourcemaps/8795a9889db74563ddd43eb0a897a2384129a619/extensions/image-preview/dist/extension.js.map